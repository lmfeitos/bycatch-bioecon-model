---
title: "Interaction between species life history and sale price is crucial for holistic fisheries management"
subtitle: "Bioeconomic simulation modeling - Chapter 1"
author: "Leonardo Feitosa"
date: "09/29/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE)

library(tidyverse)
library(here)

# file path
basedir <- "G:/Meu Drive/PhD Project - Fisheries bycatch/Bycatch project/Chapter 1/analyses/"
outdir <- file.path(basedir, "model_outs") # calls present data from raster files

```

# Introduction

Fisheries management strategies have traditionally focused on the target species, thus leaving the secondary target and bycatch species under significantly weaker management (Hall & Mainprize, 2005). Recently, efforts for managing the whole catch of fisheries have been made, which led to conflicts with fishers due to fisheries closures (Gilman, 2011), significant economic losses, and social conflicts between managers and stakeholders (Gilman et al., 2019), while incidentally caught species continue to face high extinction risk. 

These species are often considered to be weak stocks, since they generally have low reproductive rates, high longevity, and late sexual maturity (Hastings et al., 2017). Therefore, they have a weak capacity to withstand fishing pressure regardless of how strong it is. This is the case for several marine megafauna species, including sharks, rays, mammals, sea birds, turtles, and several species of large bony fishes (Burgess et al., 2018; Dulvy et al., 2014). However, some of these incidentally caught species have also become highly valuable to fishers because of new market demands, which makes holistic fisheries management an increasingly complex and important task (Costello et al., 2016). This recent increased value has the potential to shift fishing effort from already depleted stocks to other relatively less exploited ones, thus creating new pressures on other populations.

While price-abundance relationships are mostly known as the effect that the interaction between supply and demand have on end prices of goods and services, their effect on the exploitation patterns of commercially important species is relatively poorly understood. One of the main theories about the effect of price-abundance relationships to the conservation of exploited species is the Anthropogenic Allee Effect (AAE), which states that the individual price of a species or one of its byproducts increases as they become rarer (Courchamp et al 2006). Indeed, this is the case for several luxury goods such as rhino horns, elephant tusks, fish swim bladders, sea cucumbers, etc (refs).

Although the traditional fisheries literature treats harvesting to be limited by the economic costs involved in catching fish, species subjected to the AAE are more likely to have continued fishery harvests, since its catch becomes more lucrative as stocks are depleted. Therefore, this scenario is extremely difficult for fisheries management to be effective. A recent study by Holden & McDonald-Madden (2017) modeled the effect of harvest levels and initial population sizes on a species subjected to price-abundance relationships and harvesting intensity, and found that regardless of the initial population size, if harvest profits were higher than costs, the population would become extinct. 

However, the interaction between luxurious and non-luxurious species in a harvest system with poor selectivity still needs to be explored. Our goals with this study are to model such a multi-species harvesting system with differential price-abundance relationships for each species. With this model we intend to estimate the effect of the price-abundance relationships on the harvesting patterns for the species in the system and the effect that different management strategies can have on the stock outcomes. Finally, we use real-world data from species known to be part of the luxury seafood trade as validation to our model.

# Research question:
- What are the effects of price abundance relationships on the harvest patterns of a multispecies fishery under different management scenarios?

# Objectives:

- Develop a bioeconomic model to explore the effect of price abundance relationships on the harvest scenarios of a multispecies fishery under different management strategies (open access/no management; management for the target (strong) stock; management for the bycatch (weak) stock; ecosystem-based management).
- Compare the predicted effects with real-world examples and the conservation statuses of such stocks.
- Fit known weak stock species in a gradient of value categories and compare their position in the gradient with their conservation statuses assessed by IUCN.
- Discuss potential management/market strategies to ensure long-term sustainability and rebuilding of depleted stocks.

### List of parameters:
- K = carrying capacity
- r = per capita growth rate
- q = catchability of stocks
- c = cost of fishing

### List of variables:
- N = population size
- P = price

#### Base equations:

- Strong stock size ($Ns$):

$$
N_s = \frac{K_s * (c * q_s * r_w + K_w * p_w * q_w * (q_w * r_s - q_s * r_w))} {(K_w * p_w * q_w^2 * r_s) + (K_s * p_s * q_s^2 * r_w)}
$$

- Weak stock size ($Nw$):

$$
N_w = \frac{K_w * (c * q_w * r_s + K_s * p_s * q_s * (- q_w * r_s + q_s * r_w))} {(K_w * p_w * q_w^2 * r_s) + (K_s * p_s * q_s^2 * r_w)}
$$

- Effort ($e$):

$$
e = \frac{(-c + K_s * p_s * q_s + K_w * p_w * q_w) * r_s * r_w} {(K_w * p_w * q_w^2 r_s) + (K_s * p_s * q_s^2 * r_w)}
$$

- Price function ($P$)

$$
P = A * c^-f
$$
Where $P$ is price, $A$ is a constant, $c$ is the cost of harvest, and *f* is the price flexibility.

#### Model assumptions:
- The relative price of the target and bycatch species, whichever is the highest, drives fisheries targeting.
- Strong stocks can sustain higher fishing pressure than weak stocks.
- Bycatch weak stocks have worse conservation statuses than target strong stocks.
- Open access fisheries are more prone to suffer from economic losses than managed fisheries.
- Open access fisheries are more likely to deplete their stocks due to overharvesting than managed ones.
- Prices of fishing products are affected by price-abundance relationships.
- The Anthropogenic Allee Effect (AAE) can only occur in open access scenarios.
- Multispecies systems where the bycatch species has higher value than the target species are bound to suffer an AAE, regardless of the management strategies in place.

#### Extinction assumptions:
- Extinction occurs if and only if profits ($\pi$) > 0 at the level of effort that drives the species of interest extinct.
- If *f* > $\beta$, then profits increase with declining abundance when the stock is small. This can drive the species extinct, but won't necessarily be the only equilibrium.  

- General extinction criteria (G)

$$
\lim_{w\to0} (\pi = E (p_w * q_w * N_w + p_s * q_s * N_s)) > 0
$$

- Courchamp et al (2006) extinction criteria (C) - Anthropogenic Allee Effect

Weak stock would go extinct even without the strong stock.

$$
\lim_{w\to0}; \pi > 0; p_w * q_w * N_w > 0
$$

- Bycatch criteria (B)

$$
\lim_{w\to0}; \pi > 0; p_s * q_s * N_s - c > 0
$$

If the Courchamp criteria is not true, than the general extinction criteria is true if and only if the bycatch criteria is also true. This means that if the weak stock wouldn't go extinct on its own, the species can only become extinct through G if it is a weak stock and suffers enough bycatch from the fishery targeting the strong stock.

## Initial exploratory models
### First model

In this first model, I'll write out the dynamics of a fishery with two species having the same **r** and different catchability coefficients (qw > qs). The price for the weak stock will be dependent on the abundance of the strong stock, the abundance of the weak stock, and the level of fishing effort.

```{r, echo = TRUE}
# Parameter values:
r_s = 1 # intrinsic growth rate of the strong stock
r_w = 1 # intrinsic growth rate of the weak stock
k_s = 1 # carrying capacity of the strong stock
k_w = 1 # carrying capacity of the weak stock
q_s = 0.1 # catchability of the strong stock
q_w = 0.1 # catchability of the weak stock
c = 0.05 # overall harvesting costs
p_s = 1 # price for the strong stock
```

```{r}
# model equations
## Strong stock
n_strong <- function(K_s, K_w, r_s, r_w, q_s, q_w, p_s, p_w, c){
  N_s <- ( K_s * (c * q_s * r_w + K_w * p_w * q_w * (q_w * r_s - q_s * r_w)  ) ) / (K_w * p_w * q_w^2 * r_s) + (K_s * p_s * q_s^2 * r_w )
  return(N_s)
}

## Weak stock
n_weak <- function(K_s, K_w, r_s, r_w, q_s, q_w, p_s, p_w, c){
  N_s <- ( K_w * (c * q_w * r_s + K_s * p_s * q_s * (- q_w * r_s + q_s * r_w)  ) ) / (K_w * p_w * q_w^2 * r_s) + (K_s * p_s * q_s^2 * r_w )
  return(N_s)
}

## Fishing effort
e <- function(K_s, K_w, r_s, r_w, q_s, q_w, p_s, p_w, c){
  e <- ( (-c + K_s * p_s * q_s + K_w * p_w * q_w) * r_s * r_w ) / (K_w * p_w * q_w^2 * r_s) + (K_s * p_s * q_s^2 * r_w)
  return(e)
}
```

```{r}
# Simulation 1
p_w_vec <- seq(0, 10, 0.1)
n_weak_vec <- n_weak(k_s, k_w, r_s, r_w, q_s, q_w, p_s, p_w = p_w_vec, c)
n_strong_vec <- n_strong(k_s, k_w, r_s, r_w, q_s, q_w, p_s, p_w = p_w_vec, c)
```


### Second model

In this second model, I'll write out the dynamics of a fishery with two species having different **r** values (r_s > r_w) and the same catchability coefficient (qw = qs). The price for the weak stock will be dependent on the abundance of the strong stock, the abundance of the weak stock, and the level of fishing effort.

```{r}
r_w2 = 0.8
q_w2 <- q_s
n_weak_vec_2 <- n_weak(k_s, k_w, r_s, r_w2, q_s, q_w2, p_s, p_w = p_w_vec, c)
```



### Third model

In this third model, I'll write out the dynamics of a fishery with two species having different **r** values (r_s > r_w) and the same catchability coefficient (qw = qs). The price for the weak stock will be dependent on the abundance of the strong stock, the abundance of the weak stock, and the level of fishing effort.

```{r}
r_w3 = 0.6
n_weak_vec_3 <- n_weak(k_s, k_w, r_s, r_w3, q_s, q_w2, p_s, p_w = p_w_vec, c)
```

### Fourth model

In this fourth model, I'll test the result of using an **r** value of 0.5 on the weak stock dynamics as a function of price.


```{r}
r_w4 = 0.5
n_weak_vec_4 <- n_weak(k_s, k_w, r_s, r_w4, q_s, q_w2, p_s, p_w = p_w_vec, c)
```

### What happens if r is smaller for both species?

```{r}
r_s2 = 0.09
r_w2 = 0.07
p_w_vec <- seq(0, 10, 0.1)
n_weak_vec_5 <- n_weak(k_s, k_w, r_s2, r_w2, q_s, q_w, p_s, p_w = p_w_vec, c)
n_strong_vec_2 <- n_strong(k_s, k_w, r_s2, r_w2, q_s, q_w, p_s, p_w = p_w_vec, c)
```


## Model results for varying values of r

```{r, message= FALSE, warning = FALSE}
plot(x = p_w_vec, y = n_strong_vec,
     type = "l", col = "black",
     lwd = 2, las = 1, ylim = c(0, 4),
     xlab = "Weak stock price", ylab = "Stock size")
lines(x = p_w_vec, y = n_strong_vec_2,
      col = "gray50", lwd = 2)
lines(x = p_w_vec, y = n_weak_vec,
      col = "blue", lwd = 2)
lines(x = p_w_vec, y = n_weak_vec_2,
      col = "goldenrod4", lwd = 2)
lines(x = p_w_vec, y = n_weak_vec_3,
      col = "darkgreen", lwd = 2)
lines(x = p_w_vec, y = n_weak_vec_4,
      col = "darkred", lwd = 2)
lines(x = p_w_vec, y = n_weak_vec_5,
      col = "brown", lwd = 2)
legend(x = 6, y = 3.7,
       legend = c("Strong stock, r = 1", "Strong stock, r = 0.09",
                  "Weak stock 1, r = 1", 
                  "Weak stock 2, r = 0.8", "Weak stock 3, r = 0.6", 
                  "Weak stock 4, r = 0.5", "Weak stock 5, 5 = 0.07"),
       col = c("black", "gray50", "blue", "goldenrod4", "darkgreen", "darkred", "brown"),
       lty = c(1,1))
```

- For values of `r_w` < 0.5 the curve becomes concave and negative. For `r_w` equal 0.5 the curve is flat. For `r_w` > 0.5 the curve is convex and positive.




```{r}
plot(x = p_w_vec, y = n_strong_vec_2,
     type = "l", col = "black",
     lwd = 2, las = 1,ylim = c(0, 2),
     xlab = "Weak stock price", ylab = "Stock size")
lines(x = p_w_vec, y = n_weak_vec_2,
      col = "blue", lwd = 2)
title(main = "Lower values of r")
legend(x = 6, y = 1.5,
       legend = c("Strong stock, r = 0.09", "Weak stock, r = 0.07"),
       col = c("black", "blue"),
       lty = c(1,1))
```

### Species equilibria as a function of effort

Introducing the concept of vulnerability:

$$V_i = \frac{q_i}{r_i}$$

$$n_i = \frac{N_i}{K_i}$$
```{r}
v_s = 0.1
v_w = 0.15
e_vec = seq(0, 10, 0.1)
ns_vec <- 1 - e_vec * v_s
nw_vec <- 1 - e_vec * v_w
```

```{r}
plot(x = e_vec, y = ns_vec,
     type = "l", col = "brown",
     lwd = 2, las = 1, ylim = c(-1, 1),
     xlab = "Effort", ylab = "Equilibrium scaled abundances, ni")
lines(x = e_vec, y = nw_vec,
      col = "blue", lwd = 2)
abline(h = 0, col = "black", lwd = 1)
legend(x = 1, y = -0.5,
       legend = c("Strong stock", "Weak stock"),
       col = c("brown", "blue"),
       lty = c(1,1))
```


# Model scenarios
- two species, the target (strong stock) with value and the bycatch (weak stock) without any value
- two species, the target (strong stock) with a higher value than the bycatch (weak stock) and both having the exponential price function
- two species, the target (strong stock) with a higher value than the bycatch (weak stock) but only the bycatch has an exponential price function.
- two species, the weak stock with higher value than the strong stock and the same price function
- only one species, the weak stock with the same price function


### First scenario
*weak stock price = 0.1*

```{r, echo = TRUE}
# Parameter values
r_s2 = 1
r_w2 = 0.9
p_w1 <- 0.1
```


```{r}
p_s_vec <- seq(0, 10, 0.1)
n_strong_vec_1 <- n_strong(k_s, k_w, r_s2, r_w2, q_s, q_w, p_s = p_s_vec, p_w1, c)
n_weak_vec_1 <- n_weak(k_s, k_w, r_s2, r_w2, q_s, q_w, p_s = p_s_vec, p_w1, c)
```

```{r}
plot(x = p_s_vec, y = n_strong_vec_1-2,
     type = "l", col = "black",
     lwd = 2, las = 1, ylim = c(0, 4),
     xlab = "Strong stock price", ylab = "Stock size")
lines(x = p_s_vec, y = n_weak_vec_1,
      col = "blue", lwd = 2)
title(main = "Weak stock price = 0.1")
legend(x = 6, y = 3.9,
       legend = c("Strong stock, r = 1", "Weak stock, r = 0.9"),
       col = c("black", "blue"),
       lty = c(1,1))
```

- Conclusion: the weak stock goes extinct even for extremely small values of the strong stock price, while the strong stock doesn't really change meaningfully.

### Second scenario
*strong stock has a higher value than the weak stock*

```{r}
r_s2 = 1
r_w2 = 0.9
p_s_vec_2 <- seq(0, 10, 0.1)
p_w_vec_2 <- seq(0, 9, 0.1)
n_strong_vec_2 <- n_strong(k_s, k_w, r_s2, r_w2, q_s, q_w, p_s = p_s_vec_2, p_w = p_w_vec_2, c)
n_weak_vec_2 <- n_weak(k_s, k_w, r_s2, r_w2, q_s, q_w, p_s = p_s_vec_2, p_w = p_w_vec_2, c)
```


```{r}
plot(x = p_s_vec_2, y = n_strong_vec_2,
     type = "l", col = "black",
     lwd = 2, las = 1, ylim = c(0, 4), xlim = c(0, 8.8),
     xlab = "Strong stock price", ylab = "Stock size")
lines(x = p_s_vec_2, y = n_weak_vec_2,
      col = "blue", lwd = 2)
title(main = "Strong stock price > Weak stock price")
legend(x = 5.5, y = 3.9,
       legend = c("Strong stock, r = 1", "Weak stock, r = 0.9"),
       col = c("black", "blue"),
       lty = c(1,1))
```

**this is weird, probably wrong**

- Conclusion: the weak stock goes extinct and the strong stock price has a more intense effect on the weak stock size than on the strong stock size.

### Third scenario

*strong stock with a higher value than the weak stock but only the bycatch has an exponential price function.* NO IDEA HOW TO DO THIS

```{r}

```




### Fourth scenario

*The weak stock with higher price than the strong stock*

```{r}
r_s2 = 1
r_w2 = 0.9
p_s_vec_4 <- seq(0, 9, 0.1)
p_w_vec_4 <- seq(0, 10, 0.1)
n_strong_vec_4 <- n_strong(k_s, k_w, r_s2, r_w2, q_s, q_w, p_s = p_s_vec_4, p_w = p_w_vec_4, c)
n_weak_vec_4 <- n_weak(k_s, k_w, r_s2, r_w2, q_s, q_w, p_s = p_s_vec_4, p_w = p_w_vec_4, c)
```


```{r}
plot(x = p_w_vec_4, y = n_strong_vec_4,
     type = "l", col = "black",
     lwd = 2, las = 1, ylim = c(0, 4), xlim = c(0, 10),
     xlab = "Weak stock price", ylab = "Stock size")
lines(x = p_w_vec_4, y = n_weak_vec_4,
      col = "blue", lwd = 2)
title(main = "Weak stock price > Strong stock price")
legend(x = 5.5, y = 3.9,
       legend = c("Strong stock, r = 1", "Weak stock, r = 0.9"),
       col = c("black", "blue"),
       lty = c(1,1))
```

**this is weird, probably wrong**

### Fifth scenario
only one species (weak stock) with the same price function. *I believe this would require a few modifications to the model*


```{r}

```




## Simulation for each variable and parameter variations

```{r, include = FALSE}
# Paremeter settings
# r1 <- 0.2
# k1 <- 1
# r2 <- 0.4
# k2 <- 1.5
# t <- 1:100
```

```{r, include = FALSE}
# library(tidyverse)
# df <- tibble(year=1:100,
#              sp=NA,
#              biomass=NA,
#              effort=NA,
#              catch=NA)
# 
# df$biomass[1] <- k1
```

```{r, include = FALSE}
# # Exploitation rate (catch/biomass)
# er <- 0.1
# # Simulate population
# i <- 1
# # Bt+1 = Bt + rBt(1-Bt/K) - Ct
# for(i in 1:nrow(df)){
#   # Get this year biomass
#   b_curr <- df$biomass[i]
#   # Calculate catch
#   catch <- er * b_curr
#   # Calculate surplus production
#   sp <- r1*b_curr*(1-b_curr/k1)
#   # Calculate next years biomass
#   b_next <- b_curr + sp - catch
#   # Record everything
#   df$biomass[i+1] <- b_next
#   df$sp[i] <- sp
#   df$catch[i] <- catch
# }
# #
# plot(biomass ~ year, df, ylim=c(0, 1))
```

```{r scenario simulations}
# Building df of scenarios
scenarios_df <- expand.grid(r_s = seq(0.2, 1, 0.2),
                            k_s = seq(1, 5, 1),
                            q_s = seq(0.01, 0.5, 0.1),
                            p_s = seq(1, 10, 1),
                            r_w = seq(0.05, 0.5, 0.1),
                            k_w = seq(0.5, 2.5, 0.5),
                            q_w = seq(0.01, 0.1, 0.1),
                            p_w = seq(1, 20, 2),
                            c = 0.05) %>% 
  mutate(scenario_id = 1:nrow(.))

# test scenario
r_s <- scenarios_df$r_s[1]
k_s <- scenarios_df$k_s[1]
q_s <- scenarios_df$q_s[1]
p_s <- scenarios_df$p_s[1]
r_w <- scenarios_df$r_w[1]
k_w <- scenarios_df$k_w[1]
q_w <- scenarios_df$q_w[1]
p_w <- scenarios_df$p_w[1]
c <- scenarios_df$c[1]




run_model <- function(r_s, k_s, q_s, p_s, r_w, k_w, q_w, p_w, c){
 
  # Derive effort
 e <- ((k_s - c * p_s * q_s + k_w * p_w * q_w) * r_s * r_w ) /
   (k_w * p_w * q_w^2 * r_s) + (k_s * p_s * q_s^2 * r_w)
  
  # Derive weak stock biomass
 
  N_w <- (k_w * (c * q_w * r_s + k_s * p_s * q_s * (- q_w * r_s + q_s * r_w))) /
   (k_w * p_w * q_w^2 * r_s) + (k_s * p_s * q_s^2 * r_w)
  
 # Derive strong stock biomass
 
   N_s <- (k_s * (c * q_s * r_w + k_w * p_w * q_w * (q_w * r_s - q_s * r_w))) /
   (k_w * p_w * q_w^2 * r_s) + (k_s * p_s * q_s^2 * r_w)
  
  # Build output
  output <- data.frame(e = e, N_s = N_s, N_w = N_w)
 
  # Plot outout
  #if(plot==F){
  # 
  #}
 
  # Return
  return(output)
 
 
}

i = 1

for(i in 1:nrow(scenarios_df)){
 
  # Extract params
  r_s <- scenarios_df$r_s[i]
  r_w <- scenarios_df$r_w[i]
  k_s <- scenarios_df$k_s[i]
  k_w <- scenarios_df$k_w[i]
  q_s <- scenarios_df$q_s[i]
  q_w <- scenarios_df$q_w[i]
  p_s <- scenarios_df$p_s[i]
  p_w <- scenarios_df$p_w[i]
  c <- scenarios_df$c[i]
  sc_id <- scenarios_df$scenario_id[i]
 
  # Run model
  output <- run_model(r_s = r_s, r_w = r_w, k_s = k_s, k_w = k_w,
                      q_s = q_s, q_w = q_w, p_s = p_s, p_w = p_w, c = c) %>% 
    mutate(sc_id = sc_id)
  
  if(i == 1){
    output_1 <- output
  }
  else{
    output_1 <- rbind(output_1, output)
  }

}
```

```{r}
output_join <- output_1 %>% 
  rename(scenario_id = sc_id) %>% 
  left_join(scenarios_df, by = "scenario_id") %>% 
  relocate(scenario_id, .before = e)

output_tidy <- output_join %>% 
  mutate(price_ratio = p_s / p_w) %>% 
  mutate(prod_ratio = r_s / r_w) %>% 
  mutate(k_ratio = k_s / k_w) %>% 
  mutate(q_ratio = q_s / q_w) %>% 
  pivot_longer(cols = e:N_w,
               names_to = "variables",
               values_to = "values") %>% 
  pivot_longer(cols = c(p_s, p_w),
               names_to = "stock_prices",
               values_to = "prices") %>% 
  pivot_longer(cols = c(r_s, r_w),
               names_to = "stock_growth_r",
               values_to = "r") %>% 
  pivot_longer(cols = c(q_s, q_w),
               names_to = "stock_q",
               values_to = "q") %>% 
  pivot_longer(cols = c(k_w, k_s),
               names_to = "stock_k",
               values_to = "k") 

output_price <- output_tidy %>% 
  select(scenario_id, variables, values, stock_prices, prices, price_ratio) %>% 
  distinct_all()

output_growth <- output_tidy %>% 
  select(scenario_id, variables, values, stock_growth_r, r, prod_ratio) %>% 
  distinct_all()

output_k <- output_tidy %>% 
  select(scenario_id, variables, values, stock_k, k, k_ratio) %>% 
  distinct_all()

output_q <- output_tidy %>% 
  select(scenario_id, variables, values, stock_q, q, q_ratio) %>% 
  distinct_all()

#write_csv(output_price, file = file.path(outdir, "price_ranges.csv"), col_names = T)
#write_csv(output_growth, file = file.path(outdir, "growth_ranges.csv"), col_names = T)
#write_csv(output_k, file = file.path(outdir, "k_ranges.csv"), col_names = T)
#write_csv(output_q, file = file.path(outdir, "q_ranges.csv"), col_names = T)

# read in the output .csvs
output_price <- read_csv(file.path(outdir, "price_ranges.csv"))

output_growth <- read_csv(file.path(outdir, "growth_ranges.csv"))

output_k <- read_csv(file.path(outdir, "k_ranges.csv"))

output_q <- read_csv(file.path(outdir, "q_ranges.csv"))
```


```{r}
ggplot() +
  geom_col(data = output_price %>% filter(stock_prices == "p_w"), 
           aes(x = prices, y = values/1000000, fill = variables)) +
  facet_wrap(~ variables,
             scales = "free_y") +
  labs(x = "Price ranges",
       y = "Variable size (mil)") +
  theme_bw() +
  theme(strip.background = element_rect(fill = "transparent"))
```


```{r}
output_gp <- output_price %>% 
  left_join(output_growth, by = c("scenario_id", "variables", "values"))


ggplot(data = output_gp %>% filter(variables == "N_w")) +
  geom_point(aes(x = price_ratio, y = prod_ratio, color = variables)) +
  labs(x = "Price ratio (s:w)",
       y = "Productivity ratio (s:w)") +
  theme_bw()
```

```{r}
ggplot() +
  geom_col(data = output_growth, aes(x = r, y = values/1000000, fill = variables)) +
  facet_wrap(~ variables,
             scales = "free_y") +
  labs(x = "Intrinsic growth rate (r) ranges",
       y = "Variable size (mil)") +
  theme_bw() +
  theme(strip.background = element_rect(fill = "transparent"))
```

```{r}
ggplot() +
  geom_col(data = output_k, aes(x = k, y = values/1000000, fill = variables)) +
  facet_wrap(~ variables,
             scales = "free_y") +
  labs(x = "Carrying capacity (K) ranges",
       y = "Variable size (mil)") +
  theme_bw() +
  theme(strip.background = element_rect(fill = "transparent"))
```

```{r}
ggplot() +
  geom_col(data = output_q, aes(x = q, y = values/1000000, fill = variables)) +
  facet_wrap(~ variables,
             scales = "free_y") +
  labs(x = "Catchability (q) ranges",
       y = "Variable size (mil)") +
  theme_bw() +
  theme(strip.background = element_rect(fill = "transparent"))
```




